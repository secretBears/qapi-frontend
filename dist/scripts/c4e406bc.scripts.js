"use strict";angular.module("qapiFrontendApp",["ngCookies","ngResource","ngSanitize","ngRoute","angular-loading-bar"]).config(["$routeProvider","cfpLoadingBarProvider",function(a,b){a.when("/",{templateUrl:"views/index.html",controller:"MainCtrl"}).when("/play",{templateUrl:"views/play.html",controller:"PlayCtrl"}).when("/about/",{templateUrl:"views/about.html",controller:"MainCtrl"}).when("/finish/",{templateUrl:"views/finish.html",controller:"FinishCtrl"}).otherwise({redirectTo:"/"}),b.includeBar=!1}]).run(["$rootScope",function(a){a.menuhidden=!0,a.username="Justin Bieber",a.isPlaying=!1,a.toggleMenu=function(){a.menuhidden=!a.menuhidden}}]),angular.module("qapiFrontendApp").factory("Game",["$http","$window","$timeout","$rootScope",function(a,b,c,d){var e,f=function(){this.reset()};return f.prototype.reset=function(){this.numberofquestions=10,this.rightQuestions=0,this.givenAnswers=[],this.questioncount=1,this.question={},this.questionGiven=!0,this.coords={},this.loading=0},f.prototype.init=function(){var a=this;navigator.geolocation.getCurrentPosition(function(b){a.coords=b.coords,a.getNewQuestion()})},f.prototype.getNewQuestion=function(){var b=this;b.selectedAnswer=-1,b.indexOfRightAnswer=-1,b.questionGiven=!1,d.isPlaying=!0;var c=b.coords.latitude,e=b.coords.longitude,f="http://qapi.herokuapp.com/api/"+c+"/"+e;b.loading++,a({method:"GET",url:f}).success(function(a){b.question=a,b.loading--}).error(function(){console.log("ERROR: fetching data from QAPI"),b.loading--,b.question={id:20,question:"Frage 20",place:"Linz",answers:[{answer:"20 answer 1",isTrue:!1},{answer:"20 answer 2",isTrue:!0},{answer:"20 answer 3",isTrue:!1},{answer:"20 answer 4",isTrue:!1}]}})},f.prototype.giveAnswer=function(a,e){var f=this;if(!f.questionGiven){this.questionGiven=!0,f.selectedAnswer=e;var g={};g.question=f.question.question,g.answer=a;for(var h,i=0;i<f.question.answers.length;i++){var j=f.question.answers[i];j.isTrue&&(h=j.answer,f.indexOfRightAnswer=i)}a===h&&f.rightQuestions++,g.isTrue=a===h,g.rightAnswer=h,f.givenAnswers.push(g),c(function(){f.questioncount<f.numberofquestions?(f.getNewQuestion(),f.questioncount++):(d.isPlaying=!1,b.location.href="/#/finish")},200)}},e||(e=new f),e}]),angular.module("qapiFrontendApp").controller("PlayCtrl",["$scope","$http","$window","Game",function(a,b,c,d){a.game=d,a.game.reset(),a.game.init()}]),angular.module("qapiFrontendApp").controller("FinishCtrl",["$scope","$http","$window","Game",function(a,b,c,d){a.game=d}]),angular.module("qapiFrontendApp").controller("MainCtrl",[function(){}]),angular.module("qapiFrontendApp").controller("GameCtrl",["$scope","$http","$window","Game",function(a,b,c,d){a.game=d,a.game.numberofquestions=a.game.numberofquestions||0,a.game.rightQuestions=a.game.rightQuestions||0}]);